---
title: "Challenge 2: Latent-space models"
author: Pablo Barbera
date: "August 10, 2017"
output: html_document
---

How well do latent-space models work when we move to countries with party competition in multiple dimensions? We will now explore this question in the context of the UK.

The file "data/UK-follower-network.rdata" contains the matrix of users who followed at least 10 members of the UK Parliament as of mid-2015.

Load the matrix into R. What are its dimensions?

```{r}
library(Matrix)
library(tweetscores)
# adjacency matrix
load("../data/UK-follower-network.rdata")
dim(y)
```

Run correspondence analysis on this matrix.


```{r}
# fitting CA model
res <- tweetscores::CA(y, nd=3)
```

Explore which MPs are at the extremes of the distributions. What do you find?

```{r}
# results
head(res$colcoord)
head(res$colnames)

# merging with data
users <- read.csv("../data/UK-mps-data.csv", stringsAsFactors=FALSE)
users <- merge(users, data.frame(
	Twitter=tolower(res$colnames), phi1=res$colcoord[,1], 
	phi2=res$colcoord[,2], phi3=res$colcoord[,3], stringsAsFactors=F))

# who is on the extremes
head(users[order(users$phi1),c("Twitter", "Party", "phi1")],n=10)
tail(users[order(users$phi1),c("Twitter", "Party", "phi1")],n=10)

head(users[order(users$phi2),c("Twitter", "Party", "phi2")], n=10)
tail(users[order(users$phi2),c("Twitter", "Party", "phi2")], n=10)

head(users[order(users$phi3),c("Twitter", "Party", "phi3")], n=10)
tail(users[order(users$phi3),c("Twitter", "Party", "phi3")], n=10)

```

Given party discipline in the UK, we don't have good measures of ideology based on roll-call votes. However, we can explore how the ideology estimates are distributed within and across parties. To do so, merge the estimates with the party-MP correspondences available in "data/UK-mps-data.csv". Then, compute the aggregate ideology for MPs within each party. Replicate this for the first three dimensions. What do you find?

```{r}
agg <- aggregate(cbind(phi1, phi2, phi3) ~ Party, data=users, FUN=mean)
agg[order(agg$phi1),]
agg[order(agg$phi2),]
agg[order(agg$phi3),]


library(ggplot2)
p <- ggplot(users, aes(x=-phi1, y=Party))
pq <- p + geom_point()
pq

p <- ggplot(users, aes(x=phi2, y=Party))
pq <- p + geom_point()
pq

p <- ggplot(users, aes(x=phi3, y=Party))
pq <- p + geom_point()
pq

```

